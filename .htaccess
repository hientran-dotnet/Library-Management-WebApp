RewriteEngine On

# Allow direct access to assets from clean URLs
RewriteRule ^assets/(.*)$ ui/assets/$1 [L]

# Allow direct access to APIs
RewriteRule ^apis/ - [L]

# Allow direct access to health check
RewriteRule ^health\.php$ - [L]

# Debug headers
Header always set X-Rewrite-Debug "htaccess-loaded"

# Redirect root to books page (internal rewrite)
RewriteRule ^$ ui/books.html [L]

# Handle books.html at root level (internal rewrite)
RewriteRule ^books\.html$ ui/books.html [L,E=REWRITTEN:1]

# Handle members.html at root level (internal rewrite)
RewriteRule ^members\.html$ ui/members.html [L,E=REWRITTEN:1]

# Handle borrowing.html at root level (internal rewrite)
RewriteRule ^borrowing\.html$ ui/borrowing.html [L,E=REWRITTEN:1]

# Handle dashboard at root level (internal rewrite)
RewriteRule ^dashboard\.html$ ui/index.html [L,E=REWRITTEN:1]

# Allow direct access to health check
RewriteRule ^health\.php$ - [L]

# Allow direct access to APIs
RewriteRule ^apis/ - [L]

# Block access to sensitive files
RewriteRule ^(config|database|deployment|tools)/ - [F]
